<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1140, initial-scale=1.0" />
  <title>WCC 2025 Personalized DP</title>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">
  <!-- Open Graph and Twitter Card for social media thumbnail preview -->
  <meta property="og:title" content="WCC 2025 Personalized DP" />
  <meta property="og:description" content="Create your personalized DP for Warri City Crusade 2025!" />
  <meta property="og:image" content="https://rcnwarri.github.io/WARRI-CITY-CRUSADE-2025/thumbnail.jpg" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://rcnwarri.github.io/WARRI-CITY-CRUSADE-2025/" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="WCC 2025 Personalized DP" />
  <meta name="twitter:description" content="Create your personalized DP for Warri City Crusade 2025!" />
  <meta name="twitter:image" content="https://rcnwarri.github.io/WARRI-CITY-CRUSADE-2025/thumbnail.jpg" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #e5ffe9 0%, #c2e9fb 100%);
      min-height: 100vh;
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    .container {
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 8px 32px rgba(15, 68, 60, 0.14);
      padding: 32px 24px 24px 24px;
      max-width: 540px;
      width: 100%;
      margin: 40px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin-top: 0;
      margin-bottom: 18px;
      color: #17594A;
      font-size: 2.1rem;
      font-weight: 800;
      text-align: center;
      letter-spacing: 1px;
    }
    .dp-preview {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 22px;
    }
    canvas {
      width: 100%;
      max-width: 540px;
      border-radius: 18px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
      background: #f8fafb;
      transition: box-shadow 0.3s;
    }
    .controls {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      margin-bottom: 10px;
    }
    input[type="file"], input[type="text"] {
      width: 90%;
      max-width: 340px;
      padding: 13px 12px;
      font-size: 17px;
      border-radius: 8px;
      border: 1.5px solid #17594A;
      background: #f8fafb;
      transition: border-color 0.2s;
      margin: 0 auto;
      box-sizing: border-box;
    }
    input[type="text"]:focus {
      border-color: #0F443C;
      outline: none;
    }
    button {
      width: 92%;
      max-width: 340px;
      padding: 14px 0;
      font-size: 19px;
      font-weight: 700;
      background: #17594A;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(15, 68, 60, 0.09);
      transition: background 0.2s, box-shadow 0.2s;
      margin: 0 auto;
      margin-top: 6px;
    }
    button:hover {
      background: #09706b;
      box-shadow: 0 4px 14px rgba(15, 68, 60, 0.16);
    }
    .footer {
      margin-top: 16px;
      color: #888;
      font-size: 15px;
      text-align: center;
    }
    @media (max-width: 720px) {
      .container {
        padding: 16px 2px 16px 2px;
        max-width: 98vw;
      }
      canvas, input[type="file"], input[type="text"], button {
        max-width: 98vw;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>WCC 2025 Personalized DP</h1>
    <div class="dp-preview">
      <canvas id="dpCanvas" width="1140" height="1500"></canvas>
    </div>
    <div class="controls">
      <input type="file" id="imageUpload" accept="image/*" />
      <input type="text" id="nameInput" placeholder="Enter your name" />
      <button type="button" onclick="downloadDP()">Download DP</button>
    </div>
  </div>
  <div class="footer">
    &copy; 2025 The True Light Crusade. Made with ❤️
  </div>
  
  <script>
    const canvas = document.getElementById('dpCanvas');
    const ctx = canvas.getContext('2d');
    // Use JPEG as the background image
    const baseImage = new Image();
    baseImage.src = "WCC IWBA.jpg"; // <-- Make sure this file is in your repo!
    const placeholderImg = new Image();
    placeholderImg.src = "https://via.placeholder.com/600x600.png?text=Profile+Photo";
    let uploadedImg = null;
    let baseLoaded = false;
    let placeholderLoaded = false;

    baseImage.onload = function() {
      baseLoaded = true;
      if (placeholderLoaded) drawDP();
    };
    placeholderImg.onload = function() {
      placeholderLoaded = true;
      if (baseLoaded) drawDP();
    };

    document.getElementById('imageUpload').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = function(event) {
        uploadedImg = new Image();
        uploadedImg.onload = function() {
          drawDP();
        };
        uploadedImg.src = event.target.result;
      };
      reader.readAsDataURL(e.target.files[0]);
    });

    document.getElementById('nameInput').addEventListener('input', drawDP);

    function drawDP() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // Draw background without stretching
      const imgW = baseImage.width;
      const imgH = baseImage.height;
      const canW = canvas.width;
      const canH = canvas.height;
      let drawX = 0, drawY = 0, drawW = canW, drawH = canH;

      // Fit image to canvas without stretch (contain)
      const imgAspect = imgW / imgH;
      const canAspect = canW / canH;
      if (imgAspect > canAspect) {
        drawW = canW;
        drawH = canW / imgAspect;
        drawX = 0;
        drawY = (canH - drawH) / 2;
      } else {
        drawH = canH;
        drawW = canH * imgAspect;
        drawY = 0;
        drawX = (canW - drawW) / 2;
      }
      ctx.drawImage(baseImage, drawX, drawY, drawW, drawH);

      // CIRCLE (Profile Photo area)
      const circleX = 570;
      const circleY = 564;
      const circleRadius = 277.6;
      const circleDiameter = circleRadius * 2;

      // Use uploaded image if available, otherwise placeholder
      const imgToDraw = uploadedImg || placeholderImg;
      if (imgToDraw) {
        const imgAspect = imgToDraw.width / imgToDraw.height;
        let scale;
        if (imgAspect > 1) {
          scale = circleDiameter / imgToDraw.height;
        } else {
          scale = circleDiameter / imgToDraw.width;
        }
        const drawWidth = imgToDraw.width * scale;
        const drawHeight = imgToDraw.height * scale;
        const x = circleX - drawWidth / 2;
        const y = circleY - drawHeight / 2;

        ctx.save();
        ctx.beginPath();
        ctx.arc(circleX, circleY, circleRadius, 0, Math.PI * 2, true);
        ctx.closePath();
        ctx.clip();
        ctx.drawImage(imgToDraw, x, y, drawWidth, drawHeight);
        ctx.restore();
      }

      // RECTANGLE (Name area)
      const name = document.getElementById("nameInput").value;
      if (name) {
        const rectX = (canvas.width - 690) / 2;
        const rectY = 905;
        const rectW = 680;
        const rectH = 70;

        ctx.save();
        ctx.fillStyle = "#FFFFFF";
        roundRect(ctx, rectX, rectY, rectW, rectH, 18);
        ctx.fill();

        ctx.font = "bold 43px 'Montserrat', sans-serif";
        ctx.fillStyle = "#0F443C";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(name.toUpperCase(), rectX + rectW / 2, rectY + rectH / 2);
        ctx.restore();
      }
    }

    // Rounded rectangle helper
    function roundRect(ctx, x, y, width, height, radius) {
      ctx.beginPath();
      ctx.moveTo(x + radius, y);
      ctx.lineTo(x + width - radius, y);
      ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
      ctx.lineTo(x + width, y + height - radius);
      ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
      ctx.lineTo(x + radius, y + height);
      ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
      ctx.lineTo(x, y + radius);
      ctx.quadraticCurveTo(x, y, x + radius, y);
      ctx.closePath();
    }

    function downloadDP() {
      const link = document.createElement('a');
      link.download = 'WCC_2025_DP.png';
      link.href = canvas.toDataURL('image/png');
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</body>
</html>
